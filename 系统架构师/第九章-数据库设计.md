## 概述

- 数据：是==数据库中==存储的==基本对象==，是==描述事物==的符号记录
- 数据的分类：文本、图像、音视频
- 数据库（DB）：是长期存储在计算机内、有组织的、可共享的大量数据的集合
- 数据库的特点
  - 可为各种用户共享数据
  - 冗余度较小
  - 数据独立性较高
  - 易拓展
- ==数据库系统==（DBS）：能够==操作==和==管理==存储在==硬件==上的==数据==的==软件==，由以下几个部分==组成==
  - 数据库：以==文件==的形式==存储==在磁盘上
  - 硬件：==外置存储设备==，如磁盘
  - 软件：操作系统、==数据库管理系统（DBMS）==和应用程序
  - 人员：就是用户，以及==数据库管理员（DBA）==
- ==数据库**管理**系统==（DBMS）的==功能==
  - 对共享数据的有效组织、管理、存取
  - 数据库建立、运行、操作、维护，数据的存储管理

## 三级模式 两级映像

### 三级模式

- 指数据库管理系统从以下几个层次管理数据
  - ==外模式==
    - 就是跟用户交互的视图层，如页面或软件上显示个人数据
    - 只显示适合用户查看的数据，如数据库表中性别用0或1表示，在视图上则是男或女
    - 不是展示表中所有字段，而是取需要的部分展示，只允许用户看到部分数据，或不同用户看到不同数据
    - 注：表的数据是存储在磁盘上的，而**视图**看到的数据是**查询出来**的
  - ==概念模式==
    - 又称为==模式==、==逻辑模式==，在试题中看到要知道是概念模式
    - 开发人员设计表的蓝图，不是数据库里的具体的表，是抽象、语义化的描述表中应该有的字段和功用，如`students`表，里面有学生的学号、姓名、性别等
    - 跟Excel表格一样，只不过除了要设计列，还要限制每列的数据类型、长度等
  - ==内模式==
    - 又称为==物理模式==、==存储模式==
    - 就是存储在硬盘中的文件，类似Excel文件，在概念层，开发人员使用表的形式操作表文件

### 两级映像

- 因为三级==模式==都是==相互独立==，所以映像就是为了联系各层模式，体现了各层独立性和隔离性
  - ==逻辑独立==性
    - 外模式和概念模式之间的映像体现了==逻辑独立==性。即==逻辑表的修改不会影响外层视图==
    - 如：原本一张表中有“库存”、“销量”这两个字段，外模式（视图）展示的“库存”和“销量”这两个字段，并**不会随**“库存”或“销量”这两字段被**分开存到不同表**中而**显示异常**
  - ==物理独立==性
    - 概念模式和内模式之间的映像体现了==物理独立==性。即==修改了内模式不影响概念模式和外模式==
    - 如：把内模式文件的`.xls`改为`.xlxs`，或者把数据库从MySQL改为Oracle，对外模式视图和概念模式是没有影响的

## 数据库设计

- 分为以下几个步骤进行
  1. ==需求分析==（考点）
     - 产出==数据流图==、==数据字典==、==需求说明书==
     - 如：顾客是做烧烤的，想要一套财务管理系统，沟通时要确定他会**用到哪些**数据、要用这些数据**做什么**，想**得到哪些**数据，最后得出==需求说明书==
  2. ==**概念**结构设计==（考点）
     - 产出==E-R图==，即实体-联系图，也叫==概念模型==
     - 注：2~4步骤数据概念层面的设计
     - 概念设计阶段有以下几个步骤
       1. 分解出有哪些模块
       2. 设计模块的E-R图
       3. 合并模块E-R图为总E-R图
          - 合并时可能会遇到==属性冲突==（考点），即同一属性可能存在于多个模块，如学生表，有学生姓名，还有个班级表，里面有学生姓名，课程表，里面有学生姓名
          - 合并时还可能遇到==命名冲突==（考点），即**相同意义**的属性，在不同模块的E-R图中有**不同**的**命名**，或**命名相同**的属性，在不同E-R图中有**不同含义**，如学生表中，学生ID叫学号，在班级中又叫学生名
          - 合并时可能会遇到==结构冲突==（考点），即同一实体对象在一个模块中属性有5个，在另一模块中有8个属性，没有统一标准。如学生表在模块A中有3列属性，在模块B中有8列属性
  3. ==**逻辑**结构设计==
     - 产出==关系模型==，即==表结构蓝图==
  4. 物理设计
     - 确定数据分布、存储结构、访问方式，即==选用哪种数据库==、数据库需要不需要专门的备份、访问方式、存储层级结构等
  5. 数据库实际开发
     - ==实际开发数据库中表==
  6. 数据库运维
     - ==改BUG==、==调整表结构==等

## 数据模型

### 概念模型（考点）

- 就是E-R图

- E-R图

  ![E-R图.png](https://github.com/hjxool/static-resource-save/blob/main/E-R%E5%9B%BE.png?raw=true)

  - 强实体：对应一张表，如员工表示有一张表

  - 弱实体：强实体中的具体分类，如经理不是一张单独的经理表，而是员工表中员工，只不过经理在员工表中的`Job`属性值为经理

    - 注：简单来记忆就是面向对象中的继承，弱实体依赖于强实体而存在

  - 菱形：动词，表示关联关系，如经理和超市，经理 管理 超市

  - 数字或`*`号：表示1对1、1对多等对应关系，如员工和部门，员工 所属 部门，且员工和部门属于1对多的关系

    - 注：`*`号、`m`、`n`都表示多个

  - 椭圆（一般题目中没有）：表示属性，用于描述实体中有哪些属性

    ![E-R图2.png](https://github.com/hjxool/static-resource-save/blob/main/E-R%E5%9B%BE2.png?raw=true)

  - 实体集：就是表，比如学生表，里面每个学生就是实体

### 关系模型（考点）

- 就是表结构，跟Excel表一样

  ![关系模型图.png](https://github.com/hjxool/static-resource-save/blob/main/%E5%85%B3%E7%B3%BB%E6%A8%A1%E5%9E%8B%E5%9B%BE.png?raw=true)

- 优点

  - 结构简单、清晰易懂
  - 存取路径对用户透明，从而数据独立，简化数据库开发，即没有`a.b.c`，直接取姓名等属性即可

- 缺点

  - 由于存取路径透明，查询效率往往不如非关系数据模型
    - 如用户表和朋友表，要获得一个用户的朋友关系，需要进行表连接，通过一个表查另一个表中数据，而非关系数据模型（如MongoDB），可以直接存储用户和他们的好友

### 网状模型

- 就是把E-R图中的E（实体）取出，以一对一、一对多、多对多的形式连线

### 面向对象模型

- 采用面向对象方式设计数据库，以对象为单位，对象包括属性和方法，具有类和继承
- 注：一般都是用结构化法，从顶向下设计，不会用到面向对象模型

### 数据模型 三要素

- 数据==结构==
  - 即有哪些属性、属性值类型、属性值长度
- 数据==操作==
  - 即**增删改查**
- 数据的==约束==条件
  - 即**范式**和**约束**
    - 范式
      - 第一范式（1NF）：要求每一列都是原子值，**不能有重复**的列
      - 第二范式（2NF）：要求**非主键**列完全**依赖**于**主键**，如学生表中，学号是主键，学生的其他属性取决于学号多少
      - 第三范式（3NF）：要求非主键列不能依赖于其他非主键列，如学号是主键，学生的姓名不能由学生的成绩值决定，只取决于学号
    - 约束
      - 主键约束：要求每一**行**数据都有一个**唯一标识**，如学号
      - 外键约束：即用于**表之间关联**的**唯一标识**，如在课程表中，学号用于定位到学生表中具体学生，学生表中也有课程号定位到课程表中具体哪个课程
      - 唯一约束：要求某一列或某几列的值在表中是唯一的
        - 注：与**主键约束**的区别在于**唯一约束**可以有多个“主键”，即多个列的值都可以是唯一值
      - 非空约束：要求某一列的**值不能为空**，如订单表中，订单日期可以设置为非空约束，确保每个订单都有一个日期