## 网络互联模型及协议

### 网络功能和分类

- 计算机网络功能
  - 数据==通信==
  - 资源==共享==
  - 管理==集中==化
  - 实现==分布式==处理
  - ==负载均衡==
- 性能指标
  - 速率（每秒多少兆）
  - 带宽（每秒最大==上限==）
  - 吞吐量（每秒==成功传输==数据量）
  - 时延（传输数据的延迟）
  - 利用率（真实传输速率 / 带宽 的百分比）
- 非 性能指标
  - 费用（办网费用）
  - 质量（能否穿墙）
  - 标准化
  - 可靠性
  - 可拓展性
  - 可升级性
  - 易管理性
  - 可维护性
- 按 ==分布范围== 分类
  - ※局域网（LAN）
    - 分布距离 ==1km== 以内
    - 使用场景
      - 房间、楼栋、校园
    - 速率
      - 4**M**bps ~ 1**G**bps
  - 城域网（MAN）
    - 分布距离 ==10km==
    - 使用场景
      - 城市
    - 速率
      - 50**K**bps ~ 100**M**bps
  - ※广域网（WAN）
    - 分布距离 ==100km== 以上
    - 使用场景
      - 国家、全球
    - 速率
      - 9.6**K**bps ~ 45**M**bps
- 按 ==拓扑结构== 分类
  - 总线型
    - 计算机节点都连到一根总线上
    - 利用率低、干扰大、价格低
      - 干扰大：一台机器出问题会影响总线上其他机器
  - 星型
    - 常见于家庭路由器
    - 交换机形成的局域网、中央单元负荷大
  - 环型
    - 闭环
    - 流动方向固定、效率低、扩充难
      - 效率低：每台机器的瓶颈都成为了整个网络的瓶颈
      - 扩充难：一旦加入新机器，就得重新搭建
  - 树型
    - ==总线型==的扩充、分级结构
      - 总线型的扩充：比 总线型 多了==分级结构==
  - 分布型
    - 任意节点连接、管理难、成本高
      - 任意节点连接：每台机器都要知道其他机器的地址以及==映射关系==
      - 管理难：一旦有机器出了问题，要对其他节点的机器更新信息

### 网络互联模型

- 概念

  - 即网络上能找到的机器两两间如何连接

  - 如果是本地的、机器少，直接找根 **网线** 就能连接
  - 如果有多台，就找个 **交换机** ，交换机通过机器的MAC地址互相连接
    - MAC地址：每台网络设备都有自己**唯一**的MAC地址
  - 再远一点，如果有多个网段，但是同属一个==局域网==，加配 **路由器** ，路由器之间通过 ==IP== 连接
    - IP地址：也是唯一的，但分 广域 和 局域网 内的IP地址
  - 更远一些，如果 局域网 之间要连接，就需要使用**国际标准**组织制定的标准，即 ==OSI体系标准==

- OSI体系结构

  - 考点：每层相关 协议、作用
  - 分7层
    - 建立==连接==依靠 物理层、数据链路层、网络层
    - ==传输==数据依靠 传输层
      - 传输层：决定传输方式，如快递选中通还是德邦
    - ==数据==形式依靠 会话层、表示层、应用层
      - 简单记，决定数据是画出来，是用英文还是中文等等

- TCP/IP 体系结构

  - 是对 OSI体系结构 的简化
  - 如OSI的会话层、表示层、应用层合并为 ==应用层==
    - 物理层、数据链路层合并为 ==网络接口层==
    - 传输层、网络层 原样保留

#### OSI体系结构

1. 物理层

   - 简单理解，就是==物理层面==连根网线将开放系统连接
   - 协议：RS232、V.35、RJ-45、FDDI等
   - 都是用 ==二进制==传输，形式就是电信号、光信号等
   - 主要设备
     - 中继器
     - 集线器

2. 数据链路层

   - 因为二进制传输不安全，缺乏加密，所以有数据链路层，将二进制封装为以 ==帧== 为单位的信息
     - 帧：就像快递包裹，包裹里是二进制数据，包裹外有标签(控制信息)，从而保证传输过程不会损坏和丢失。通常包括帧头、数据部分、帧尾
       - 帧头：包裹标签，告诉网络这个数据包从哪儿来，要到哪儿去
       - 帧尾：包裹的封条，即校验信息，检查数据在传输过程中有没有出错

   - 是针对 ==MAC地址== 建立的链路
   - 协议：IEEE802.3/.2、HDLC、PPP、ATM等
   - 主要设备
     - ==交换机==
     - 网桥

3. 网络层

   - 在传输单位上做的升级，将==数据分组==用于传输
     - 类似大件行李通过拆分运送，将一块数据==分段==传输
   - 解决==路由选择==、==网络拥塞==、==异构网络互联==的问题
     - 网络层好比一个国际快递公司，从一个国家送到另一个国家，即使两个国家的邮政系统完全不同，国际快递公司使用统一的标准和流程，确保包裹能够顺利送达
   - 协议：IP、IPX等
   - 主要设备
     - ==路由器==

- 通过上面三层，机器在网络中就能==定位==到了，机器间==连接方式==也确定了

4. 传输层
   - ==端口到端口==连接，传输报文
     - 端：比如电脑上多个端口
       - 与数据链路层连接方式的区别
         - ==数据链路层==是 ==MAC 到 MAC==
         - ==传输层==是 ==端口 到 端口==
           - 注意！MAC标识的是==设备==，端口标识的是==应用程序和服务==，所以MAC到MAC和端到端是不同的！
     - 报文：传输层会把数据分成一个个小块，每个小块就叫做“报文”
       - 与网络层数据分组的区别
         - 网络层分的更细！好比寄一套书给朋友，网络层是将每本书装进不同的包裹，并写上寄件人和收件人的地址
         - 而传输层相当于把装着一个个包裹再分组，并标注上序号
       - 注意！UDP不会拆分报文，这里主要描述的是TCP协议下的情况
   - 协议：TCP、UDP等
   - 主要设备
     - ==网关==
5. 会话层
   - 主要是确认==通信的权限==。服务包括通信控制、检查点设置、中断重连、安全验证
   - 协议：==SSL==、SQL、RPC等
   - 主要设备
     - 网关
6. 表示层
   - 将原始数据转换成应用层指定的形式，具备转换数据的能力
     - 如页面上的图片，其实在后台是原始数据，而表示层就是将原始数据处理成能直观看到的
   - 协议：JPEG、ASCII、GIF等
   - 主要设备
     - 网关
7. 应用层
   - 直接和用户交互的那一层，主要作用就是提供==网络服务==
     - 如：WEB页面就是应用层
   - 协议：HTTP、FTP、Tenlent等
   - 主要设备
     - 网关

#### 网络常用设备

- 中继器
  - 用于：==物理层==
  - 作用：对接收信号的再生和发送，==只起到扩展**传输距离**的作用==，对高层协议透明，但使用个数有限(如在以太网中只能使用4个)
    - 如马拉松中途会有补给站，喝口水补充体力才能继续跑
- 网桥
  - 用于：==数据链路层==
  - 作用：根据==帧物理地址==进行网络之间的==信息转发==，可缓解网络通信繁忙，提高效率。==只能连接在**相同**数据链路层**协议**下的网络==
    - 帧物理地址：即==MAC地址==
    - 如：家里有一个客厅的网络，和书房的网络，网桥会读取数据 帧 中的源MAC地址和目的MAC地址，然后根据这些地址来决定是否转发数据帧到另一个网络段
- 路由器
  - 用于：==网络层==
  - 作用：通过==IP地址==进行网络间信息转发，可完成 异构网络 间的互联互通。==只能连接**相同**网络层**协议**的**子网**==
- 网关
  - 用于：4~7层，即传输层到应用层
  - 作用：最复杂 的网络互联设备，可以连接==不同协议的子网==
- 集线器
  - 用于：物理层
  - 作用：多端口==中继器==
- 二层==交换机==
  - 用于：数据链路层
  - 作用：传统意义上的交换机，多端口==网桥==
    - 注意：因为本质是网桥，所以通过MAC地址识别转发，而==路由器==则是通过==IP地址==

#### 数据是如何互相传输的？

- 其实就是层层打包，另一方在逐层拆包
- 如 A主机 的 应用层 将传输数据(如data里面的字段)打包，给到 表示层 明确是JPG还是DES加密，再到 会话层 进行SSL加密，再到 传输层 进行TCP加密，再到 网络层 将目标I，源P地址包进来，再到 数据链路层 将收件人发件人的MAC地址包进来，再到 物理层 将数据转换成 电信号 ，通过 ==通信介质== 即网线、光纤等，连接到 B主机 ，B主机 通过 物理层 将电信号还原回二进制数据，再通过 数据链路层 找MAC地址，再到 网络层 找IP地址，再到 传输层 知晓是TCP协议，再到 会话层 知道是SSL，再到 表示层 进行解密，再到 应用层 将数据展示

### 常见网络协议

#### 网络层协议

- ※==IP==
  - 网络层 **最重要** 的核心协议，在 源地址 和 目的地址 之间传输数据，无连接、不可靠。它将 差错检测 和 流量控制 等服务授权给其他各层协议，这正是TCP/IP能够高效工作的保证。网络层 功能主要由 IP 来提供，除了 端到端 分组分发功能，还有其他扩充功能。如数据分块和重组功能用于突破 数据链路层 对帧大小的限制，使得很大的 IP 数据包可以以较小的分组在网络传输
    - 无连接：如给朋友寄快递，包裹上写了寄件人和收件人的地址，快递公司不需要提前通知对方“我要寄包裹了”，直接发就行
    - 不可靠：如寄快递，快递公司不保证每个包裹都一定能送到，有可能会丢件、延误或者顺序错乱
- ICMP（网际控制报文协议）
  - 用于在 IP主机、路由器 之间传递==控制消息==
    - 控制消息：网络通不通，路由是否可达等网络本身的消息。如访问网站，电脑回发送请求到网站服务器，服务器收到会恢复一个应答消息，吐过能收到应答，说明网络连接正常，没收到则说明网络有问题
- ARP（地址解析协议）和 RARP（反向地址解析协议）
  - ARP：将 IP地址 转换为 MAC地址
  - RARP：将 MAC地址 转换为 IP地址
- IGMP（网际组管理协议）
  - 网络 ==组== 管理协议，允许网络上的计算机参加==多播==，是计算机向 相邻 组播路由器报告自己成员的协议，支持组播
    - 组播(多播)：一种网络通信方式，由一个发送者把数据发送给多个接收者，但不是发给所有人，而是发给一个特定的组。如微信群发消息，这个消息只有群里的成员能看到，而不是你所有的微信好友
    - 何为管理协议：在一个小区里，每个住户（主机）都可以选择加入某个兴趣小组（多播组），而小区的物业管理（路由器）需要知道哪些住户加入了哪些小组，以便在有活动（数据包）时通知相关的住户。IGMP协议就像是物业管理用来收集和更新这些信息的工具

#### 传输层协议

- ※TCP（传输控制协议）
  - 在IP协议提供的不可靠数据服务的基础上，采用了==重发技术==，为应用程序提供了一个==可靠的、面向连接的、全双工==的数据传输服务
    - 重发技术
      - 超时重传：如发了一条微信消息，如果对方一直没回，会再发一次确认对方是否收到
      - 快速重传：接收方收到一个失序的数据包时，会发送重复的ACK给发送方，告诉它==上一个正确==接收到的数据包序号。发送方如果==连续==收到==三个相同==的ACK，就会立即重传下一个数据包，而不必等待超时。如发了一连串的快递包裹，结果中间一个丢了，收件人会连续告诉你“我只收到第5个包裹”，你就知道第6个包裹丢了，并立即重发
      - 选择性确认：这个机制允许接收方告诉发送方具体哪些数据包已经收到，哪些还没有收到。这样发送方只需要重传那些丢失的数据包，而不是重传整个窗口的数据。如发了一套书给朋友，他告诉你“第1、2、4、5本收到了，第3本没收到”，你就只需要重发第3本书
    - 面向连接的：双方必须建立连接。TCP使用3种机制实现面向连接
      1. 使用==序号==对数据报进行==标记==。使得 传输层 在向 会话层 及以上层传递数据之前==调整失序==的数据包
         - 数据报：网络通信中的一个基本单位。数据报头部包含源地址、目标地址、数据长度、校验和等。
      2. TCP使用确认、校验、定时器提供可靠性。当接收者识别到数据错误，会通知发送者，或者 当接收者一段时间没有回复确认消息，发送者会认为数据包没有到达，这两种情况发送者都会重传数据
         - 就是TCP最经典的 三次握手，四次挥手 建立连接方式
      3. TCP使用窗口机制调整数据流量。并且窗口大小随网络情况调整
         - 窗口机制：即数据==分组==的==大小==
  - 一般用于数据量较少，对可靠性要求高的场合
- UDP（用户数据报协议）
  - ==不可靠、无连接==协议，能保证通信，与TCP相比错误检测功能弱的多，但不是没有
    - UDP的错误检测方式：校验和
      - UDP在发送数据时，会计算总和，然后将总和值填入UDP头部的对应字段。接收方在收到数据后，会重新计算数据总和，并与头部中的总和值进行比较。一致，说明数据报在传输过程中没有发生错误，不一致，则说明数据报可能在传输过程中出现了错误
      - 这种校验方式只能直到数据传输是否出错，无法校正，且==发送方可以不计算 校验和==，这样接收方就无法进行校验
  - 一般用于数据量大，对可靠性要求不高，但要求速度快的场合
  - 特性
    - ==无连接==：发送数据前不需要建立连接，减少了开销和发送数据前的延迟
    - 尽最大努力交付：不保证可靠，因此主机不需要维持复杂的连接状态表
    - UDP是==面向报文的==：==UDP==对于应用层传下来的数据，不会进行拆分或合并，而是==一次性交付完整数据==
      - 注：==TCP==会将应用层传下来的数据==进行分组==
    - ==没有 拥塞控制==：因此网络拥塞不会使主机发送速率降低。这对实时应用很重要
    - UDP支持一对一、一对多、多对一、多对多的==交互通信==
    - UDP的==首部==开销小：只有8字节，比TCP的20字节短
- 总结
  - TCP提供可靠性，UDP提供高传输速率

#### 应用层协议

- 基于 **TCP** 的是==可靠传输==，基于 **UDP** 的是==不可靠传输==
- FTP
  - 基于 TCP
  - ==文件传输==协议。控制文件的双向传输
- HTTP
  - 基于 TCP
  - ==超文本==传输协议。用于从WWW服务器==传输**页面文件**到本地浏览器==的传输协议，使用==SSL加密后==的协议为==HTTPS==
    - 超文本：即嵌入的链接，也叫超链接。使用户可以在不同内容之间跳转
- SMTP 和 POP3
  - 基于 TCP
  - 简单邮件传输协议。用于从 源地址 到 目标地址 传送邮件的规则。SMTP 用于发送，POP3 用于接收
- Telnet
  - 基于 TCP
  - 远程连接协议。用于==远程访问==其他计算机
- TFTP
  - 基于 UDP
  - ==小文件==传输协议。使用==**超时重传**方式保证数据送达==
- SNMP
  - 基于 UDP
  - 简单 网络管理协议。就像是网络管理员的助手，帮助他们==远程查看==和控制网络设备的状态
- DHCP
  - 基于 UDP
  - 动态主机配置协议。基于C/S模型，为主机分配IP地址，有三种方式：固定分配、动态分配、自动分配
    - C/S模型：即客户机/服务器模型，是一种网络架构。如在线游戏，任务被分成两个部分，客户端和服务器端，客户端发送请求和渲染，服务器处理玩家数据和游戏逻辑，并返回给客户端
- DNS
  - 基于 UDP
  - 域名解析协议。通过 ==域名== 解析出 ==IP地址==
    - 域名：互联网的“地址簿"，如`www.example.com`
    - IP地址：服务器的门牌号，服务器的唯一标识。如`192.168.1.1`
      - 注：服务器下可以有多个设备，每个设备也有自己的IP地址，这个叫 ==内网IP==，而服务器的IP是 ==公网IP==

## ※ IP地址 及 子网

### ※ IPV4

- IPV4地址是一个==**32**位的**二进制**逻辑地址==，为表示方便，一般用==点分十进制==方式表示
  - 点分十进制：将32个0、1每==8位==转化成==十进制==，变成==4个十进制==，再将这4个十进制用`.`间隔，如`128.11.3.31`
  - 因为是==8位==二进制转换，所以==0~255==范围由此得来
  - 注：二进制以==8位==为一个==字节(1byte)==，`1byte == 8bits`
- IP地址分由 ==网络号== 和 ==主机号== 两部分组成，如`192.168.1.10`，它的==网络号==是`192.168.1.1`，表示设备属于`192.168.1.1`这个网络，==主机号==是`10`，表示这个网络中的第10号设备
  - 与 公网IP 和 内网IP 的区别
    - **公网IP和内网IP**：区分设备是在**局域网**还是**互联网**中
      - 公网IP（公有地址）：是分配给设备的**全球唯一**的IP地址
      - 内网IP（私有地址）：是分配给**局域网内**部设备的IP地址
    - **网络号和主机号**：==划分==和==标识==**同一网络环境**中的设备

#### 有分类表示方式

- ※ IP地址根据 ==网络号 位数==的不同，划分为以下几类
  - ※ A类
    - 范围从`0.0.0.0`到`127.255.255.255`，网络号只占一位，即只占`127`这一位，后面三位`255.255.255`是可自由分配的==主机号==
      - 范围：指 网络号 的范围，只能从`0~127`，为什么是`127`？因为 A类 特点，32位二进制中，**第一位**必须是 **0**，如最大`01111111 11111111 11111111 11111111`
    - 特点
      - 二进制==首位==必须是==0==
      - ==网络号只占一位==
  - ※ B类
    - 范围从`128.0.0.0`到`191.255.255.255`，网络号占两位，即占`191`、`255`这两位，后面两位`255.255`是可自由分配的==主机号==
    - 特点
      - 二进制==头两位==必须是==10==
        - 如`10111111 11111111 11111111 11111111`
      - ==网络号占两位==
  - ※ C类
    - 范围从`192.0.0.0`到`223.255.255.255`，网络号占三位，即占`223`、`255`、`255`这三位，后面一位`255`是可自由分配的==主机号==
    - 特点
      - 二进制==开头三位==必须是==110==
        - 如`11011111 11111111 11111111 11111111`
      - ==网络号占三位==
  - D类 ==组播==
    - 范围从`224.0.0.0`到`239.255.255.255`，网络号占三位，，即占`239`、`255`、`255`这三位，后面一位`255`是可自由分配的==主机号==
    - 特点
      - 二进制==开头四位==必须是==1110==
        - 如`11101111 11111111 11111111 11111111`
      - ==网络号占三位==
  - 总结
    - 总之就是==二进制头部==和==占据网络号==位数两方面特点，其次就是注意==首位区间==
    - 其实各类地址的==网络号范围==从==二进制的头部规则==就能得出

#### 无分类表示方式

- 无分类编址
  - 不按照A、B、C类规则，自动归类==网络号==，无分类编址格式：==IP地址/网络号位数==，如`128.168.0.11/20`，表示IP地址为`128.168.0.11`，==网络号==占20位，因此主机号占`30 - 20 = 12`位，也可以划分子网
    - 占20位：这里说的占多少位是指二进制长度，从左往右数多少个，总共4 * 8 = 32位
    - `128.168.0.11/20`：转化成二进制为`10000000.10101000.00000000.00001011`，其中前20位`10000000.10101000.0000`为网络号，后面`0000.00001011`为主机号
  - ==无分类==编址方式比==有分类==表示==更细致==！
  - 注意！即使划分了 子网 ，`/20`表示的也是==网络号==。**不包括**==子网号==

### 子网 及 子网掩码

#### 子网

- 子网划分
  - 一般公司在申请网络时，会获得一个很大的网络，所以一般采用子网划分的方式来划分网络，即==自定义网络号位数==，从而自定义主机号位数，不会浪费资源
  - 因此就有了==子网==的概念，IP地址划分为A、B、C类后，还可以进一步划分，==主机号==拿出几位作为==子网号==，就可以划分出多个子网，此时IP地址组成为：==网络号 + 子网号 + 主机号==
  - 注意！==子网号==可以全为0或全为1，**但**==主机号不能全为0或全为1==！所以==主机数==上限需要-2
    - 主机号全为0：为==网络地址号==
      - 表示==整个网络==
      - 如子网掩码`255.255.255.0`，IP地址`192.168.1.10`，那么`192.168.1.0`就是==网络地址号==，==用来标识一个特定的网络，而不是网络中的某一台主机==
    - 主机号全为1：为==广播地址号==
      - 用于向网络中所有主机发送数据包。
      - 如在`192.168.1.0`的 网络地址 中`192.168.1.255`就是==广播地址号==，当一个数据包发送到这个地址时，网络中的==所有主机都会接收==到这个==数据包==
    - 主机数：主机号全为1时的十进制表示，即==最大可分配设备数==。如C类网络192.168.1.10，末尾为主机位，用二进制表示是8位，如果8位全是1，转化成十进制是255，即最大可分配设备数，但因为网络地址号和广播地址号占了2个，所以最大可分配设备数为255 - 2 = 253个
- ==子网掩码==
  - ==网络号==和==子网号==都为==1==，==主机号==都为==0==，这样的地址就叫子网掩码
    - 注意！这里说的1和0都是二进制，即子网掩码为`11111111.11111111.11111111.00000000`，转化成十进制表示就是`255.255.255.0`
  - 作用：通过与 IP地址 对比，区分网络号和主机号
    - 如：IP地址`192.168.1.10`，子网掩码是`255.255.255.0`，由于子网掩码网络号和主机号都为1，也就是255，因此可得前三位是网络号`192.168.1.0`，剩下一位是主机号`10`，
    - 如：IP地址`192.168.1.10`，子网掩码是`255.255.255.192`，有不是0或255的十进制数，说明8位bit中混杂1和0，子网掩码转化成二进制得：`11111111.11111111.11111111.11000000`，可见前3 * 8 + 2 = 26位为网络号部分，剩下6位为主机号部分，因虽然不是完整的8位一分隔，但并不是说这就是**无分类编址**或**有分类表示方式**，==子网掩码并不能直接决定==是否是无分类编址，用无分类编址表示是`192.168.1.0/26`，按分类表示的话，因为192在C类范围，因此是C类网络，但是明显只用C类表示没有无分类编址表示的细致

- 超网
  - 与==子网划分==的区别在于，子网划分 从主机号中取出一部分作为==子网号==，而==超网==由==网络号==去一部分作为==主机号==，因此 超网 是 子网划分 的**逆过程**
- 三级 IP地址
  - 即 ==网络号 + 子网号 + 主机号==

#### 子网计算

- 将==IP地址==与==子网掩码==两者的二进制逐位进行 ==与== 运算，得到==子网==的网络地址
  - 与 运算：计算双方都为1，结果才为1，有一者为0，结果都为0
  - 如IP地址`192.168.1.10`，子网掩码`255.255.255.192`
    - IP地址对应二进制`11000000.10101000.00000001.00001010`
    - 子网掩码对应二进制`11111111.11111111.11111111.11000000`
    - 进行 与 运算后，得`11000000.10101000.00000001.00000000`
    - 该主机所在子网的网络号为`192.168.1.0`
- 因此路由器在相互交换信息的时候，除了给出目标地址，和下一跳地址外，还需要给出目标地址的子网掩码，用以==确定目标地址下具体哪个子网段==
- 题目
  - IP地址：`131.1.123.24/27`与 IP地址：`131.1.123.43/27`是否在==同一网段==？
    - 解析
      - 27 表示`131.1.123`这部分为网络号，且尾数 24 和 43 的二进制中还要抽前 3 位作为网络号
      - 24 的二进制表示`000 11000`
      - 43 的二进制表示`001 01011`
      - 可以看出两者前 3 位网络号二进制表示并不相同，虽然`131.1.123`部分相同，但是==网络号只要不一样就不在同一网段==

### IPV6

- 是为了解决==IPV4地址分配耗尽==、路由表急剧膨胀、缺乏对QoS的支持、本身==不提供安全机制==\、移动性差等问题，在95年提出的下一代IP
  - 路由表急剧膨胀：一个公司持有一个公网地址，公司不断拓展自己的子网分支，导致路由表条目增加
  - QoS：即网络质量指标
  - 移动性差：设备在不同网络之间移动时，难以保持其IP地址不变，导致连接中断和通信问题
- 特性
  - IPV6地址长度为==128位==，比IPV4可分配地址数量==扩大==了2^96^倍
  - ==灵活==的IP报文头部格式，使用固定格式的拓展头部取代了IPV4可变长度的选项字段
  - IPV6简化了报文头部格式，加快报文转发，提高了吞吐量
    - 简化了报文头部格式：没有了IPv4中的一些不常用字段，比如头部**校验和**字段，并且固定的40字节长度
  - 通过==身份认证==和==隐私权==**关键特性**，提高了安全性
  - 支持更多的服务类型
  - 允许协议继续演变，来增加新功能
- 构成
  - 共==128位==，==16位==(IPV4两倍)为一段，共==8段==(IPV4两倍)，==每段==的16位==二进制转换==为==4位十六进制==，每段之间用 `:`号 隔开
    - 如`2001:0da8:d001:0001:0000:0000:0000:0001`
      - 开头连续的0可以去掉，简化为`2001:da8:d001:1:0:0:0:1`，注意！每段最少保留1位数，因此当一段中只有0时，要保留1位
- 总结与 IPV4 相比的优势
  - IPV6有更大的地址空间
  - IPV6有更小的路由表
  - IPV6增加了==组播==和==对流==支持
    - 注：IPV4也支持组播，但是范围比IPV6小很多，==IPv6能更好的支持多媒体应用，比如视频会议、在线直播等==
    - 对流：指将数据包发送给一组接收者中的最近一个。如：想访问一个网站，这个网站在全球有多个服务器节点，IPv6的对流技术会让你连接到离你最近的那个节点，确保你能以最快的速度访问网站
  - IPV6加入了自动配置的支持
    - 自动配置：设备接入网络时自动获取IP地址，而不需要手动配置或者依赖DHCP服务器
      - 如一个新的智能家居设备，比如智能灯泡。把它接入家里的Wi-Fi网络后，这个灯泡会自动生成一个唯一的IPv6地址，基于网络前缀和设备的MAC地址。这个过程不需要你手动输入任何IP地址，也不需要网络管理员的干预，设备就能直接上网了
  - IPV6具有更高的安全性

### IPV4 和 IPV6 共同工作时的兼容技术

- 双协议栈技术
  - 即同时运行IPV4和IPV6两套协议。通过固定规则在IPV4和IPV6之间互相转换，从而实现通信
    - 如IPv6的低32位可以直接转换为IPv4地址
      - 低32位：简单来说就是IPv6的后4段（或32位二进制数）直接可以表示成IPv4地址。如`::ffff:192.168.1.1`，后4位`192.168.1.1`就是IPv4地址
        - `::ffff:`为固定写法，表示IPv6 128位二进制数中，前128 - 32 = 96位都是0
- 隧道技术
  - 在 IPv4 网络上建一条能够传输 IPv6 数据的隧道
    - 在IPv6数据前加一个IPv4的首部，封装为IPv4数据
  - 隧道技术包括：6to4隧道、6over4隧道、ISATAP隧道
- 翻译技术
  -  利用专门的翻译设备（如转换网关），对IP报头进行转换，对分组进行语义翻译，使得**纯**IPv6和IPv4站点之间能够透明通信

## 域名系统DNS

### 基本概念

- 作用是将人类易读的域名（如`www.example.com`）转换为机器可读的IP地址（如`93.184.216.34`）
- 端口号
  - ==公共应用==进程一般==小于==1024
  - ==用户进程==一般==大于==1024，如`8080`
- 构成
  - DNS名字空间
    - 将`www.baidu.com`这样的域名分层管理和解析
      - 顶级域：`.com`
        - 顶级域又分三类
          - ==国家==顶级域名：如`.en`
          - ==通用==顶级域名：如`.com`
          - ==国际==顶级域名
      - 二级域：`baidu`
      - 三级域：`www`
  - 域名服务器
    - 如查询`www.example.com`时，会先到==根域名==服务器查`.com`的==顶级域名==服务器，再到==顶级域名==服务器查`.example.com`的==权威域名==服务器，最后找到具体==IP地址==
  - DNS客户机
    - 简单来说就是==联网设备或软件==，如浏览器输入网址时，==浏览器==就是==DNS客户机==，它会先查看==本地缓存==有没有这个网址的IP，如果没有，则会发起一个DNS查询请求，到域名服务器找对应的IP地址
  - DNS中==主机==为**最低层域名**，处于域名树的叶子端，对应一台提供服务的计算机设备
    - 如访问`www.example.com`时，`www`就是一个主机名，它对应着一台具体的服务器

### 域名查询

- 递归查询

  - 如查`www.example.com`的IP地址

    1. 本地DNS服务器不知道，就去问根DNS服务器
    2. 根DNS服务器说，你去问`.com`的顶级域名服务器
    3. 顶级域名服务器说，你去问`example.com`的权威DNS服务器
    4. 权威DNS服务器说，`www.example.com`的IP地址是`192.0.2.1`

    ==DNS服务器==会帮你一步一步地==找到==最终的IP地址，这就是==递归查询==的过程

- 迭代查询

  - 如查`www.example.com`的IP地址

    1. 本地DNS服务器不知道，就**告诉你去问**根DNS服务器
    2. 问根DNS服务器，根DNS服务器告诉你去问`.com`的顶级域名服务器
    3. 问顶级域名服务器，顶级域名服务器告诉你去问`example.com`的权威DNS服务器
    4. 问权威DNS服务器，权威DNS服务器告诉你`www.example.com`的IP地址是`192.0.2.1`

    ==自己==一步一步地去问，最终==找到==结果，这就是==迭代查询==的过程

## 网络规划与设计

### 网络系统建设

- 可分为==网络规划==、==网络设计==、==网络实施==三个环节
- ==网络设计== **原则**
  - ==采用先进、成熟的技术==
    - 在规划网络、选择技术和设备时，应重点考虑**主流**技术和设备，才能保障网络具有良好的性能，以及可靠运行
    - 如当下流行5G网络，不可能选型3G网络的设备
  - ==遵循国际标准，坚持开放性原则==
    - 具体来说就是采用大多数厂家支持的协议和标准接口
    - 如使用冷僻协议的设备，导致和第三方网络互联时无法互通，这样肯定是不行的
  - ==网络的可管理性==
    - 借助网络管理软件，完成对设备的配置、状态监视、统计、流量分析、故障报警、诊断等任务
  - ==网络系统的安全性==
    - 网络一般分内网和外网
      - 内网一般是一些数据和操作安全，通过权限控制就可以了
      - 外网一般是防黑客和病毒
  - ==灵活性和扩充性==
    - 灵活性：连接方便，设置简单，使用和维护方便
    - 扩充性：数量增加方便、增加新功能方便、网络质量提高
    - 通过采用==功能强==、==扩充好==的设备，可灵活选择 快速以太网、千兆以太网、ATM网络等模块进行配置，==关键元件==应具有==冗余备份==功能
      - 如==模块化结构==、==软件可升级==等
  - ==系统的稳定性和可靠性==
    - 先前的==采用先进、成熟的技术==方面，就与稳定性和可靠性息息相关，因为先进、成熟的设备和技术通常具有良好的==电源备份系统==、==链路备份系统==、系统也有==快速、良好的自愈能力==
  - ==经济性==
    - 选择性价比高的硬件和软件等，比如小办公室不需要很高的网络带宽，软件使用开源软件
  - ==实用性==
    - 采用新技术设备前，要考虑平台建设能否同步进行，力求满足目前需要，又能适应未来发展

### 规划与设计

#### 为什么要这样划分？

- 分工明确。更容易==定位和解决问题==
- 每一层==专注==于自己的功能，==拓展==起来更==灵活==，不需要对网络进行大规模改造，
- ==分层==的设计，==避免==了==单点故障==，且更易于==策略控制==

#### 核心层（高速公路）

#### 汇聚层（主干道）

- **非必须**，比起 核心层 和 接入层 重要性没那么高，对于简单的网络架构可以不用 汇聚层

- ==核心层== 和 ==接入层== 的交界处，负责==网络访问策略控制==、==数据包处理==、==过滤==、==寻址==，以及其他数据处理的任务

#### 接入层（分支）

- ==**直接**面向用户==连接。目的是允许终端用户连接到网络，解决相邻用户之间的互访需求(如A和B通过==接入层的**交换机**==互相访问)
- 负责==用户管理功能==，==用户信息收集==工作
  - 用户管理功能：如地址认证、==用户认证==、计费管理等
  - 用户信息收集：如用户的IP地址、MAC地址、访问日志等