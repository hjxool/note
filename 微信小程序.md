## 小程序特点

- 没有DOM

- 使用组件化开发，类似Vue单文件

- 项目体积不能超过2M，否则无法上线

- 文件功能

  - `.js`逻辑功能
  - `.wxml`视图结构，同`.html`
  - `.wxss`样式，同`.css`
  - `.json`存储数据

- 使用`rpx`适配方案，而不是`rem`

  - 单位：`rpx`
  - 规定任何屏幕==宽度==都为`750rpx`
    - 例：`375px`宽度的手机屏，它的`1rpx = 0.5px`，在写样式时`50px`的元素就可以设置为`100rpx`

  - 小程序会根据屏幕宽度自动计算`rpx`

- 项目最外层必须要有`app.js`

  - 用途：注册整个小程序应用
- 单个页面下使用`Page({配置项})`配置数据，类似Vue的`new Vue({配置项})`
- 没有全局对象`window`，取而代之的是`wx`
- 更新迭代很快，有的方法已经废弃，详情见[官网](https://mp.weixin.qq.com/)
- `wxml`页面元素上绑定变量使用`<image src="{{userInfo.icon}}">`

## 文件结构

- `app.wxss`公共样式

- `app.json`全局配置

  - 如：页面文件路径、窗口样式、网络超时时间等

    ```json
    {	// 在任一级目录下"新建 Page"会自动在此添加文件路径
        "pages": ["pages/index/index"]
    }

- `app.js`入口文件

- 单独页面文件夹下
  - `xxx.json`表示==当前==页面==配置==
    - 如：当前页名称
    - 配置项名和`app.json`相同，**但是**不需要在`window`下写，直接写最外层即可
  - `xxx.wxss`、`xxx.wxml`、`xxx.js/ts`当前页样式、结构、逻辑

## 静态页面

- `<view>`等于`<div>`

- `<text>`等于`<span>`

- 所有页面外层都包裹着`<page>`作为根节点，但是`<page>`默认没有高度，由内部元素撑开，所以需要在`app.wxss`或者`app.less`设置==公共样式==

  ```less
  page{
      height: 100%;
  }

## 数据绑定

- 小程序
  - `data:{}`中==初始化==数据
  - 修改数据：`this.setData({key: newValue})`
    - 修改数据是==同步==执行
  - 没有数据代理
    - `this.data.xxx`取数据
    - 只有通过`setData`修改的数据才能回显到页面
  - 数据流
    - 只有`Model -> View`
      - 后续更新支持了双向绑定，但是不支持`对象.属性`的写法
- Vue
  - `data(){return {}}`中初始化数据
  - 修改数据：`this.key = value`
  - 数据流
    - 双向数据绑定：`Model <--> View`
- React
  - `state`中初始化状态数据
  - 修改数据：`this.setSate()`
    - 在生命周期函数中是==异步==执行
    - 非生命周期函数中是==同步==执行
  - 数据流
    - 只有`Model -> View`

## 事件绑定

- 小程序分==冒泡事件==和==非冒泡事件==

- `bind`绑定事件会冒泡

  ```html
  <view bindtap="fn">屏幕点击事件</view>
  ```

- `catch`绑定事件**不会**冒泡

  ```html
  <view catchtap="fn">屏幕点击事件</view>

- 事件回调放置在生命周期函数同级

  ```ts
  Page({
      data:{},
      onLoad:{}.
      ...
      fn(){}
  })

## 路由跳转

- 需要调用API跳转

  - 路径只能是`app.json`里的绝对路径或相对路径
    - 路径不能带有`.wxml`后缀，只能用`/pages/目录/index`或`../目录/index`这种形式

  ```ts
  turnToPage(){
      // 保留当前页面跳转 跳转后有返回按钮
      wx.navigateTo({
          url: '/pages/logs/logs'
      })
      // 关闭当前页跳转 跳转后只有返回首页按钮
      wx.redirectTo({...})
   	// 关闭所有页面跳转 跳转后只有返回首页按钮
      wx.reLaunch({...})
  }

## 生命周期

- 页面==线程==和逻辑==线程==交互的时机

  ![img](https://res.wx.qq.com/wxdoc/dist/assets/img/page-lifecycle.2e646c86.png)

- 返回首页或前一页会销毁当前页`onUnload()`
  - 返回前一页只会触发`onShow()`
  - 返回首页会触发`onLoad()`、`onShow()`、`onReady()`

## 条件渲染

- ```html
  <view wx:if="{{showFlag === 1}}"></view>
  <view wx:elif="{{showFlag === 2}}"></view>
  <view wx:else></view>

## 列表渲染

- `wx:key="itemKey"`可以直接绑定数组元素属性

  ```html
  <view wx:for="{{array}}" wx:key="id"></view>
  ```

  ```ts
  data:{
      array:[
          {id:1, value:'xxxx'},
          {id:2, value:'aa'},
          {id:3, value:'vv'},
      ]
  }

## 组件

1. 新建`Component`，写结构、逻辑、样式

   ```ts
   Component({
       // 等同Vue中的props 详见官方文档-框架接口-自定义组件
       properties: {
           title: {
               type: String, //数据类型
               value: 'xxx', //属性初始值
           },
           // 简写属性
           content: String
       },
   })

2. 编辑使用组件页面对应的`xxx.json`文件

   ```json
   {
       "usingComponents": {
           // "组件名": "/文件夹/文件夹/文件名"
           "navHeader": "/components/header/header"
       }
   }

3. 在页面使用不需要将驼峰式转为短横线

   ```html
   <navHeader title="xx" content="xx"></navHeader>

## 移动端通用触控相关属性方法

- 获取手指坐标

  ```ts
  hanleTouchStart(event){
      // touches表示几根手指触屏 一般取第一个手指
      startY = event.touches[0].clientY
  }

## 多页面共享数据和方法

- 创建`xxx.js`文件